<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Caynana AI</title>

  <link rel="icon" href="data:,">
  <link rel="stylesheet" href="/css/style.css?v=1">

  <!-- Google GSI -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>

  <!-- config.js -> window.GOOGLE_CLIENT_ID -->
  <script type="module">
    import { GOOGLE_CLIENT_ID } from "/js/config.js";
    window.GOOGLE_CLIENT_ID = GOOGLE_CLIENT_ID;
  </script>

  <style>
    :root{
      --gold:#ffb300;
      --pistachio:#bef264;
      --red:#ff5252;
    }
    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }

    /* ===== MENU overlay (v5.6 ile uyumlu) ===== */
    .menu-overlay{
      position: fixed; inset: 0; background: rgba(0,0,0,0.8);
      z-index: 5000; opacity: 0; pointer-events: none; transition: .3s;
      display: flex;
    }
    .menu-overlay.open { opacity: 1; pointer-events: auto; }

    .menu-sidebar{
      width: 280px; height: 100%; background: #111;
      transform: translateX(-100%); transition: .3s cubic-bezier(0.2, 0.8, 0.2, 1);
      display: flex; flex-direction: column;
      border-right: 1px solid #333;
      padding: 20px; overflow-y: auto;
    }
    .menu-overlay.open .menu-sidebar { transform: translateX(0); }

    /* ===== Topbar d√ºzen (v5.6) ===== */
    #profileBtn { display: none !important; }

    .right-controls {
      display: flex !important; flex-direction: column !important;
      align-items: flex-end !important; gap: 6px !important; width: auto !important;
    }
    .notif-row {
      display: flex !important; flex-direction: column !important;
      align-items: flex-end !important; gap: 6px !important; position: relative !important;
    }
    .notif-topline { display: flex !important; align-items: center !important; gap: 10px !important; }
    #notifBtn { display: flex !important; align-items: center !important; padding: 6px !important; }

    .plan-chip {
      font-size: 10px !important; font-weight: 900 !important; letter-spacing: .7px !important;
      padding: 5px 10px !important; border-radius: 999px !important;
      border: 1px solid rgba(255,255,255,.10) !important; background: rgba(255,255,255,.04) !important;
      color: rgba(255,255,255,.75) !important; line-height: 1 !important; user-select: none !important;
      text-transform: uppercase !important; white-space: nowrap !important;
    }

    .yp-chip .yp-label { font-size: 0 !important; }
    .yp-chip .yp-label::after {
      content: "S.P" !important; font-size: 10px !important; font-weight: 900 !important;
      letter-spacing: .6px !important; color: rgba(255,255,255,.75) !important;
    }

    .logo-area { gap: 10px !important; }
    .seesaw-svg { width: 36px !important; height: 18px !important; }

    /* ===== Chat ta≈üma fix =====
       input-dock + altbar + footer i√ßin alttan pay bƒ±rak */
    .chat-area{
      display:flex !important;
      flex-direction:column !important;
      justify-content:flex-end !important;
      padding-bottom: 190px !important; /* input + altbar + footer */
      min-height: 0 !important;
    }
    .chat-area:empty::before { display: none !important; }

    /* ===== Alt kolay men√º (sayfanƒ±n i√ßinde sabit) ===== */
    .assistant-bar{
      position: fixed;
      left: 0; right: 0;
      bottom: 64px; /* footer √ºst√º */
      z-index: 2900;

      display:flex;
      align-items:center;
      gap: 10px;
      padding: 10px 12px;

      overflow-x:auto;
      -webkit-overflow-scrolling:touch;
      scrollbar-width:none;

      background: rgba(0,0,0,.92);
      border-top: 1px solid rgba(255,255,255,.06);
    }
    .assistant-bar::-webkit-scrollbar{ display:none; }

    .assistant-item{
      flex:0 0 auto;
      min-width: 70px;
      padding: 10px 12px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      color: rgba(255,255,255,.80);
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap: 4px;
      font-weight: 900;
      user-select:none;
      cursor:pointer;
    }
    .assistant-item:active{ transform: translateY(-1px); }
    .assistant-item .ico{ font-size: 20px; line-height:1; }
    .assistant-item .lbl{ font-size: 10px; text-transform: uppercase; letter-spacing:.2px; white-space:nowrap; }

    /* ===== Footer sabit imza ===== */
    .footer-container{
      position: fixed;
      left:0; right:0;
      bottom:0;
      z-index: 2800;
      background: rgba(0,0,0,.92);
      border-top: 1px solid rgba(255,255,255,.06);
      padding: 10px 12px calc(10px + env(safe-area-inset-bottom));
    }
    .footer-links{
      display:flex;
      gap: 16px;
      justify-content:center;
      flex-wrap:wrap;
      font-size:12px;
      font-weight:900;
      opacity:.85;
    }
    .footer-links a{ color: rgba(255,255,255,.70); text-decoration:none; }
    .footer-brand{
      margin-top:6px;
      text-align:center;
      font-size:11px;
      font-weight:900;
      color: rgba(255,255,255,.55);
    }

    /* ===== Premium Login ===== */
    .full-overlay{
      position: fixed !important;
      inset: 0 !important;
      width: 100vw !important;
      height: 100vh !important;
      background: rgba(0,0,0,0.92) !important;
      z-index: 9900 !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      opacity: 0 !important;
      pointer-events: none !important;
      transition: opacity 0.3s ease !important;
    }
    .full-overlay.active {
      opacity: 1 !important;
      pointer-events: auto !important;
    }

    #loginOverlay .login-card{
      max-width:420px !important;
      padding:28px 26px 26px !important;
      border-radius:26px !important;
      background:
        radial-gradient(1200px 400px at 0% 0%, rgba(255,179,0,.10), transparent 60%),
        radial-gradient(1200px 400px at 100% 0%, rgba(190,242,100,.08), transparent 60%),
        #0e0e0e !important;
      border:1px solid rgba(255,255,255,.12) !important;
      box-shadow:0 40px 120px rgba(0,0,0,.75) !important;
      text-align:center;
    }

    /* Google ger√ßek tƒ±klanƒ±r katman */
    .google-area{ position:relative; margin-top:16px; }
    #googleLoginBtn{
      display:flex !important; align-items:center !important; justify-content:center !important; gap:10px !important;
      width:100% !important; height:52px !important;
      background:linear-gradient(180deg,#ffffff,#f1f1f1) !important;
      color:#111 !important;
      border-radius:16px !important;
      font-weight:900 !important; font-size:15px !important;
      border:none !important;
      box-shadow:0 12px 30px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.8) !important;
      position:relative !important; z-index:1 !important;
    }
    #googleLoginBtn::before{
      content:"";
      width:20px; height:20px;
      background:url("https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg") no-repeat center/contain;
      display:inline-block;
    }
    #googleBtnWrap{
      position:absolute !important; inset:0 !important;
      width:100% !important; height:52px !important;
      z-index: 9999 !important;
      opacity:0.01 !important;
      cursor:pointer !important;
    }
    #googleBtnWrap iframe{ width:100% !important; height:100% !important; cursor:pointer !important; pointer-events:auto !important; }

    /* Apple butonu: ince ikon yok, temiz */
    #appleLoginBtn{
      display:flex !important; align-items:center !important; justify-content:center !important; gap:10px !important;
      width:100% !important; height:50px !important;
      background:rgba(255,255,255,.06) !important;
      color:rgba(255,255,255,.70) !important;
      border-radius:16px !important;
      font-weight:900 !important; font-size:14px !important;
      border:1px solid rgba(255,255,255,.12) !important;
      margin-top:10px !important;
    }
    #appleLoginBtn .applemark{ font-size:18px; line-height:1; }

    .trust-links-clean{
      margin-top:18px !important;
      font-size:12px !important;
      opacity:.65 !important;
      display:flex !important;
      gap:14px !important;
      justify-content:center !important;
      flex-wrap:wrap !important;
    }
    .trust-links-clean a{ color: rgba(255,255,255,.55) !important; text-decoration:none !important; }

    .login-footer{
      margin-top:12px;
      font-size:11px;
      font-weight:900;
      opacity:.6;
    }

    /* Toast */
    .toast{
      position:fixed;
      left: 50%;
      transform: translateX(-50%);
      bottom: 170px;
      z-index: 9999;
      background: rgba(0,0,0,.85);
      border:1px solid rgba(255,255,255,.12);
      padding: 10px 12px;
      border-radius: 14px;
      font-weight: 900;
      font-size: 12px;
      opacity:0;
      pointer-events:none;
      transition: opacity .2s ease;
      max-width: 92vw;
      text-align:center;
      white-space: pre-line;
    }
    .toast.show{ opacity:1; }
  </style>
</head>

<body>

<div class="mobile-frame" id="mobileFrame">
  <div class="topbar">
    <div class="left-controls">
      <button class="hamb-btn" id="hambBtn">‚ò∞</button>
    </div>

    <div class="brand-wrapper" id="brandWrapper">
      <div class="logo-area">
        <svg class="seesaw-svg" viewBox="0 0 40 20">
          <g class="seesaw-bar" id="seesawBar">
            <line x1="0" y1="8" x2="40" y2="8" stroke="#ccc" stroke-width="2" stroke-linecap="round" />
            <circle cx="3" cy="5" r="3" fill="#bef264" />
            <circle cx="37" cy="5" r="3" fill="#ffb300" id="orangeBall" />
          </g>
          <polygon points="17,14 23,14 20,8" fill="none" stroke="#666" stroke-width="1.5" />
        </svg>
        <div class="brand-name">Caynana AI</div>
      </div>
      <div class="slogan">Yapay Zek√¢nƒ±n Geleneksel Aklƒ±</div>
    </div>

    <div class="right-controls">
      <div class="notif-row">
        <div class="notif-topline">
          <button class="icon-btn-top" id="notifBtn" aria-label="Bildirimler">
            <svg viewBox="0 0 24 24"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path><path d="M13.73 21a2 2 0 0 1-3.46 0"></path></svg>
            <div class="badge" id="notifBadge"></div>
          </button>
          <div id="planChip" class="plan-chip">FREE</div>
        </div>

        <!-- ‚úÖ S.P + grafik -->
        <div class="yp-chip">
          <div class="yp-label">SAMƒ∞Mƒ∞YET</div>
          <div class="yp-meter"><div class="yp-fill" id="ypFill"></div></div>
          <div class="yp-num" id="ypNum">19%</div>
        </div>

        <button class="icon-btn-top" id="profileBtn" aria-label="Profil">
          <svg viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Hamburger overlay -->
  <div class="menu-overlay" id="menuOverlay">
    <div class="menu-sidebar">
      <button class="new-chat-btn" id="newChatBtn"><span>+</span> YENƒ∞ SOHBET BA≈ûLAT</button>

      <div class="profile-shortcut-wrap" id="profileShortcutMount">
        <div class="profile-shortcut-btn" id="profileShortcutBtn">
          <div class="profile-shortcut-ico" id="profileShortcutIco">üë§</div>
          <div class="profile-shortcut-text">
            <div class="profile-shortcut-title">Profil D√ºzenle</div>
            <div class="profile-shortcut-sub" id="profileShortcutName">‚Äî</div>
          </div>
        </div>
      </div>

      <div class="section-title" id="historyTitle">GE√áMƒ∞≈û SOHBETLER</div>
      <div class="history-list" id="historyList"></div>

      <!-- main.js dolduracak -->
      <div class="menu-block asistan">
        <div class="block-head">Asistan</div>
        <div class="menu-grid" id="menuAsistan"></div>
      </div>

      <div class="menu-block astro">
        <div class="block-head">Astro AI</div>
        <div class="menu-grid" id="menuAstro"></div>
      </div>

      <div class="menu-block kurumsal">
        <div class="block-head">Kurumsal</div>
        <div class="menu-grid" id="menuKurumsal"></div>
      </div>

      <div class="menu-footer-actions">
        <a class="action-link" id="logoutBtn">üõ°Ô∏è G√ºvenli √áƒ±kƒ±≈ü</a>
        <a class="action-link delete-acc" id="deleteAccountBtn">üóëÔ∏è Hesabƒ±mƒ± Sil</a>
        <div class="footer-copy">@CaynanaAI By Ozyigit's 2026</div>
      </div>
    </div>
  </div>

  <!-- Chat -->
  <div class="chat-area" id="chat"></div>

  <!-- Input (main.js kullanƒ±yor) -->
  <div class="input-dock">
    <div class="dock-inner">
      <button class="icon-btn" id="camBtn" aria-label="Kamera">
        <svg viewBox="0 0 24 24"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg>
      </button>
      <textarea id="msgInput" rows="1" placeholder="Ne lazƒ±m evladƒ±m?" spellcheck="false"></textarea>
      <button class="icon-btn" id="micBtn" aria-label="Mikrofon">
        <svg viewBox="0 0 24 24"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg>
      </button>
      <button class="send-btn" id="sendBtn" aria-label="G√∂nder">
        <svg viewBox="0 0 24 24"><path d="M22 2L11 13"></path><path d="M22 2L15 22L11 13L2 9L22 2Z"></path></svg>
      </button>
    </div>
  </div>

  <!-- ‚úÖ Kolay men√º (hamburgerdeki sayfalarƒ±n hƒ±zlƒ±sƒ±) -->
  <div class="assistant-bar" id="assistantBar">
    <div class="assistant-item" data-go="/"><div class="ico">üí¨</div><div class="lbl">Sohbet</div></div>
    <div class="assistant-item" data-go="/pages/diyet.html"><div class="ico">ü•ó</div><div class="lbl">Diyet</div></div>
    <div class="assistant-item" data-go="/pages/astro.html"><div class="ico">‚ôà</div><div class="lbl">Astro</div></div>
    <div class="assistant-item" data-go="/pages/fal.html"><div class="ico">‚òï</div><div class="lbl">Fal</div></div>
    <div class="assistant-item" data-go="/pages/saglik.html"><div class="ico">‚ù§Ô∏è</div><div class="lbl">Saƒülƒ±k</div></div>
    <div class="assistant-item" data-go="/pages/alisveris.html"><div class="ico">üõçÔ∏è</div><div class="lbl">Alƒ±≈üveri≈ü</div></div>
    <div class="assistant-item" data-go="/pages/tercuman.html"><div class="ico">üåç</div><div class="lbl">Terc√ºman</div></div>
    <div class="assistant-item" data-go="/pages/tarot.html"><div class="ico">üÉè</div><div class="lbl">Tarot</div></div>
    <div class="assistant-item" data-go="/pages/ruya.html"><div class="ico">üëÅÔ∏è</div><div class="lbl">R√ºya</div></div>
    <div class="assistant-item" data-go="/pages/dedikodu.html"><div class="ico">üó£Ô∏è</div><div class="lbl">Dedikodu</div></div>
  </div>

  <!-- Footer -->
  <div class="footer-container">
    <div class="footer-links">
      <a href="/pages/hakkimizda.html">Hakkƒ±mƒ±zda</a>
      <a href="/pages/sss.html">SSS</a>
      <a href="/pages/gizlilik.html">Gizlilik</a>
      <a href="/pages/iletisim.html">ƒ∞leti≈üim</a>
    </div>
    <div class="footer-brand">@CaynanaAI By Ozyigit's 2026</div>
  </div>

</div>

<!-- Login overlay -->
<div class="full-overlay active" id="loginOverlay">
  <div class="login-card">
    <div style="display:flex; flex-direction:column; align-items:center; gap:8px;">
      <svg viewBox="0 0 220 70" style="width:70px;height:34px;">
        <line x1="20" y1="30" x2="200" y2="30" stroke="rgba(255,255,255,.65)" stroke-width="6" stroke-linecap="round"/>
        <circle cx="30" cy="20" r="10" fill="#bef264"/>
        <circle cx="190" cy="20" r="10" fill="#ffb300"/>
      </svg>
      <div style="font-size:24px; font-weight:1000;">Caynana.AI</div>
      <div style="opacity:.75; font-weight:800; font-size:12px;">Yapay Zek√¢nƒ±n Geleneksel Aklƒ±</div>
      <div style="opacity:.85; font-weight:900; font-size:13px;">√úcretsiz √ºyelik i√ßin giri≈ü yap</div>
    </div>

    <div class="google-area">
      <button id="googleLoginBtn" type="button">Google ile Devam Et</button>
      <div id="googleBtnWrap"></div>
    </div>

    <button id="appleLoginBtn" type="button"><span class="applemark">Ô£ø</span> Apple ile Devam Et</button>

    <div class="trust-links-clean">
      <a href="/pages/hakkimizda.html">Hakkƒ±mƒ±zda</a>
      <a href="/pages/sss.html">SSS</a>
      <a href="/pages/gizlilik.html">Gizlilik</a>
      <a href="/pages/iletisim.html">ƒ∞leti≈üim</a>
    </div>

    <div class="login-footer">@CaynanaAI By Ozyigit's 2026</div>
  </div>
</div>

<div class="toast" id="toast"></div>

<!-- ‚úÖ Senin mevcut uygulama JS'in -->
<script type="module" src="/js/main.js"></script>

<script>
document.addEventListener("DOMContentLoaded", () => {

  function showToast(msg){
    const t = document.getElementById("toast");
    if(!t) return;
    t.textContent = msg;
    t.classList.add("show");
    clearTimeout(window.__toastTimer);
    window.__toastTimer = setTimeout(()=> t.classList.remove("show"), 2600);
  }

  // Hamburger yedek
  const hamb = document.getElementById("hambBtn");
  const overlay = document.getElementById("menuOverlay");
  if(hamb && overlay){
    hamb.addEventListener("click", () => overlay.classList.add("open"));
    overlay.addEventListener("click", (e)=> { if(e.target === overlay) overlay.classList.remove("open"); });
  }

  // Alt bar nav
  document.querySelectorAll(".assistant-item").forEach(el=>{
    el.addEventListener("click", ()=>{
      const go = el.getAttribute("data-go");
      if(go) location.href = go;
    });
  });

  // Logout yedek (main.js yakalasa da burada garanti)
  const logoutBtn = document.getElementById("logoutBtn");
  if(logoutBtn){
    logoutBtn.addEventListener("click", () => {
      localStorage.removeItem("caynana_user_v1");
      location.reload();
    });
  }

  // Profil shortcut boya
  function paintProfile(){
    try{
      const u = JSON.parse(localStorage.getItem("caynana_user_v1") || "{}");
      const pic = u.picture || u.avatar || u.avatar_url;
      const name = u.fullname || u.name || "‚Äî";
      const ico = document.getElementById("profileShortcutIco");
      if(ico && pic) ico.innerHTML = `<img src="${pic}" alt="avatar">`;
      const nm = document.getElementById("profileShortcutName");
      if(nm) nm.textContent = name;
    }catch(e){}
  }

  // JWT UTF8 decode (T√ºrk√ße bozulmasƒ±n)
  function parseJwtUtf8(token){
    try{
      const base64Url = token.split(".")[1];
      const base64 = base64Url.replace(/-/g,"+").replace(/_/g,"/");
      const jsonPayload = decodeURIComponent(
        atob(base64).split("").map(c => "%" + ("00" + c.charCodeAt(0).toString(16)).slice(-2)).join("")
      );
      return JSON.parse(jsonPayload);
    }catch{ return {}; }
  }

  // Login overlay
  const loginOverlay = document.getElementById("loginOverlay");
  if(localStorage.getItem("caynana_user_v1")){
    loginOverlay.classList.remove("active");
    paintProfile();
  }

  // Apple
  const apple = document.getElementById("appleLoginBtn");
  if(apple) apple.addEventListener("click", ()=> showToast("Apple giri≈üi yakƒ±nda! ≈ûimdilik Google ile devam et."));

  // Google init
  const GOOGLE_CLIENT_ID = window.GOOGLE_CLIENT_ID;
  if(!GOOGLE_CLIENT_ID){
    console.error("GOOGLE_CLIENT_ID yok (config.js).");
    return;
  }

  function handleGoogle(response){
    if(!response.credential) return;
    const p = parseJwtUtf8(response.credential);
    localStorage.setItem("caynana_user_v1", JSON.stringify({
      fullname: p.name || "",
      email: p.email || "",
      picture: p.picture || ""
    }));
    loginOverlay.classList.remove("active");
    paintProfile();
  }

  const wait = setInterval(()=>{
    if(window.google && google.accounts && google.accounts.id){
      clearInterval(wait);

      google.accounts.id.initialize({
        client_id: GOOGLE_CLIENT_ID,
        callback: handleGoogle,
        auto_select: false,
        cancel_on_tap_outside: false,
        ux_mode: "popup"
      });

      window.google.accounts.id.renderButton(
  document.getElementById("googleBtnWrap"),
  {
    type: "standard",
    theme: "outline",
    size: "large",
    width: 420,
    text: "signin_with",
    logo_alignment: "left"
  }
);
      // fallback: b√ºy√ºk butona basƒ±nca prompt
      const bigBtn = document.getElementById("googleLoginBtn");
      if(bigBtn){
        bigBtn.addEventListener("click", ()=> {
          try{ google.accounts.id.prompt(); }catch(e){}
        });
      }
    }
  }, 100);

});
</script>

</body>
</html>
